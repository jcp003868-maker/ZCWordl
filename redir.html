<script>
  const urlParams = new URLSearchParams(window.location.search);
  const link = urlParams.get("link");

  if (link) {
    document.getElementById("enlaceDirecto").href = link;

    fetch(`/api/shorten?link=${encodeURIComponent(link)}`)
      .then(res => res.json())
      .then(data => {
        if (data.corto) {
          document.getElementById("enlaceApoyar").href = data.corto;
        } else {
          document.getElementById("enlaceApoyar").remove();
        }
      })
      .catch(() => {
        document.getElementById("enlaceApoyar").remove();
      });
  } else {
    document.querySelector(".caja").innerHTML = "<h1>Error</h1><p>Falta el enlace.</p>";
  }
</script>
